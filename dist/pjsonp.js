!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):(e=e||self)["promisify-jsonp"]=r()}(this,function(){"use strict";function r(e,r){for(var t=r&&r.plainObjects?Object.create(null):{},o=0;o<e.length;++o)void 0!==e[o]&&(t[o]=e[o]);return t}function g(e,r){n.apply(e,O(r)?r:[r])}function j(e,r,t,o,n,i,a,c,l,f,u,s,p){var d=e;if("function"==typeof a?d=a(r,d):d instanceof Date?d=f(d):"comma"===t&&O(d)&&(d=d.join(",")),null===d){if(o)return i&&!s?i(r,N.encoder,p):r;d=""}if("string"==typeof d||"number"==typeof d||"boolean"==typeof d||w.isBuffer(d))return i?[u(s?r:i(r,N.encoder,p))+"="+u(i(d,N.encoder,p))]:[u(r)+"="+u(String(d))];var y,m=[];if(void 0===d)return m;if(O(a))y=a;else{var h=Object.keys(d);y=c?h.sort(c):h}for(var v=0;v<y.length;++v){var b=y[v];n&&null===d[b]||(O(d)?g(m,j(d[b],"function"==typeof t?t(r,b):r,t,o,n,i,a,c,l,f,u,s,p)):g(m,j(d[b],r+(l?"."+b:"["+b+"]"),t,o,n,i,a,c,l,f,u,s,p)))}return m}function d(e,r){var t,o=e,n=function(e){if(!e)return N;if(null!==e.encoder&&void 0!==e.encoder&&"function"!=typeof e.encoder)throw new TypeError("Encoder has to be a function.");var r=e.charset||N.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var t=p.default;if(void 0!==e.format){if(!y.call(p.formatters,e.format))throw new TypeError("Unknown format option provided.");t=e.format}var o=p.formatters[t],n=N.filter;return"function"!=typeof e.filter&&!O(e.filter)||(n=e.filter),{addQueryPrefix:"boolean"==typeof e.addQueryPrefix?e.addQueryPrefix:N.addQueryPrefix,allowDots:void 0===e.allowDots?N.allowDots:!!e.allowDots,charset:r,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:N.charsetSentinel,delimiter:void 0===e.delimiter?N.delimiter:e.delimiter,encode:"boolean"==typeof e.encode?e.encode:N.encode,encoder:"function"==typeof e.encoder?e.encoder:N.encoder,encodeValuesOnly:"boolean"==typeof e.encodeValuesOnly?e.encodeValuesOnly:N.encodeValuesOnly,filter:n,formatter:o,serializeDate:"function"==typeof e.serializeDate?e.serializeDate:N.serializeDate,skipNulls:"boolean"==typeof e.skipNulls?e.skipNulls:N.skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:N.strictNullHandling}}(r);"function"==typeof n.filter?o=(0,n.filter)("",o):O(n.filter)&&(t=n.filter);var i,a=[];if("object"!=typeof o||null===o)return"";i=r&&r.arrayFormat in m?r.arrayFormat:r&&"indices"in r?r.indices?"indices":"repeat":"indices";var c=m[i];t=t||Object.keys(o),n.sort&&t.sort(n.sort);for(var l=0;l<t.length;++l){var f=t[l];n.skipNulls&&null===o[f]||g(a,j(o[f],f,c,n.strictNullHandling,n.skipNulls,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.formatter,n.encodeValuesOnly,n.charset))}var u=a.join(n.delimiter),s=!0===n.addQueryPrefix?"?":"";return n.charsetSentinel&&("iso-8859-1"===n.charset?s+="utf8=%26%2310003%3B&":s+="utf8=%E2%9C%93&"),0<u.length?s+u:""}var c=Object.prototype.hasOwnProperty,u=Array.isArray,l=function(){for(var e=[],r=0;r<256;++r)e.push("%"+((r<16?"0":"")+r.toString(16)).toUpperCase());return e}(),w={arrayToObject:r,assign:function(e,t){return Object.keys(t).reduce(function(e,r){return e[r]=t[r],e},e)},combine:function(e,r){return[].concat(e,r)},compact:function(e){for(var r=[{obj:{o:e},prop:"o"}],t=[],o=0;o<r.length;++o)for(var n=r[o],i=n.obj[n.prop],a=Object.keys(i),c=0;c<a.length;++c){var l=a[c],f=i[l];"object"==typeof f&&null!==f&&-1===t.indexOf(f)&&(r.push({obj:i,prop:l}),t.push(f))}return function(e){for(;1<e.length;){var r=e.pop(),t=r.obj[r.prop];if(u(t)){for(var o=[],n=0;n<t.length;++n)void 0!==t[n]&&o.push(t[n]);r.obj[r.prop]=o}}}(r),e},decode:function(e,r,t){var o=e.replace(/\+/g," ");if("iso-8859-1"===t)return o.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(o)}catch(e){return o}},encode:function(e,r,t){if(0===e.length)return e;var o="string"==typeof e?e:String(e);if("iso-8859-1"===t)return escape(o).replace(/%u[0-9a-f]{4}/gi,function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"});for(var n="",i=0;i<o.length;++i){var a=o.charCodeAt(i);45===a||46===a||95===a||126===a||48<=a&&a<=57||65<=a&&a<=90||97<=a&&a<=122?n+=o.charAt(i):a<128?n+=l[a]:a<2048?n+=l[192|a>>6]+l[128|63&a]:a<55296||57344<=a?n+=l[224|a>>12]+l[128|a>>6&63]+l[128|63&a]:(i+=1,a=65536+((1023&a)<<10|1023&o.charCodeAt(i)),n+=l[240|a>>18]+l[128|a>>12&63]+l[128|a>>6&63]+l[128|63&a])}return n},isBuffer:function(e){return!(!e||"object"!=typeof e)&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},merge:function o(n,i,a){if(!i)return n;if("object"!=typeof i){if(u(n))n.push(i);else{if(!n||"object"!=typeof n)return[n,i];(a&&(a.plainObjects||a.allowPrototypes)||!c.call(Object.prototype,i))&&(n[i]=!0)}return n}if(!n||"object"!=typeof n)return[n].concat(i);var e=n;return u(n)&&!u(i)&&(e=r(n,a)),u(n)&&u(i)?(i.forEach(function(e,r){if(c.call(n,r)){var t=n[r];t&&"object"==typeof t&&e&&"object"==typeof e?n[r]=o(t,e,a):n.push(e)}else n[r]=e}),n):Object.keys(i).reduce(function(e,r){var t=i[r];return c.call(e,r)?e[r]=o(e[r],t,a):e[r]=t,e},e)}},t=String.prototype.replace,o=/%20/g,p={default:"RFC3986",formatters:{RFC1738:function(e){return t.call(e,o,"+")},RFC3986:function(e){return e}},RFC1738:"RFC1738",RFC3986:"RFC3986"},y=Object.prototype.hasOwnProperty,m={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,r){return e+"["+r+"]"},repeat:function(e){return e}},O=Array.isArray,n=Array.prototype.push,i=Date.prototype.toISOString,N={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:w.encode,encodeValuesOnly:!1,formatter:p.formatters[p.default],indices:!1,serializeDate:function(e){return i.call(e)},skipNulls:!1,strictNullHandling:!1};function e(e,r){var t,o,n=(r=r||{}).callbackNamePrefix||"__jp",i=r.callbackName||function e(r,t){t=t||0;var o=r+ +new Date+"_"+t;return void 0===window[o]?(window[o]=null,o):e(r,t+1)}(n),a=r.callbackParamName||"callback",c=r.timeout||0,l=r.qsOpts||{},f=r.params||{};function u(){o&&clearTimeout(o),t.parentNode&&t.parentNode.removeChild(t),window[i]=void 0}var s={};for(var p in s[a]=i,f)Object.prototype.hasOwnProperty.call(f,p)&&(s[p]=f[p]);return e=(e+=(~e.indexOf("?")?"&":"?")+d(s,l)).replace("?&","?"),(t=document.createElement("script")).src=e,new Promise(function(r,e){c&&(o=setTimeout(function(){u(),e(new Error("Timeout"))},c)),t.onerror=function(){u(),e(new Error("Script error"))},window[i]=function(e){u(),r(e)},function(e){var r=document.getElementsByTagName("script")[0];r?r.parentNode.insertBefore(e,r):document.head.appendChild(e)}(t)})}var a=e,f=e;return a.default=f,a});
