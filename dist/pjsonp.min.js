!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(e=e||self)["promisify-jsonp"]=n()}(this,function(){"use strict";var p=["anonymous","use-credentials",""];function e(n){return function(e){return Object.prototype.toString.call(e)==="[object "+n+"]"}}var w=e("String"),v=e("Boolean"),g=window.encodeURIComponent,O=Object.prototype.hasOwnProperty;function b(e){return w(e)&&0<e.length}function n(i,e){var n,r,t,o=b((e=e||{}).callbackNamePrefix)?e.callbackNamePrefix:"__jp",c=b(e.callbackName)?e.callbackName:function e(n,r){r=r||0;var o=n+ +new Date+"_"+r;return void 0===window[o]?(window[o]=null,o):e(n,r+1)}(o),a=b(e.callbackParamName)?e.callbackParamName:"callback",u=e.timeout||0,s=e.params||{},l=!v(e.encode)||e.encode,d=document.createElement("script");if(null!=e.crossOrigin){if(!(w(e.crossOrigin)&&-1<p.indexOf(e.crossOrigin)))return Promise.reject(new Error("Invalid crossOrigin value: "+e.crossOrigin));d.crossOrigin=e.crossOrigin}function f(){t&&clearTimeout(t),d.parentNode&&d.parentNode.removeChild(d),window[c]=void 0,r&&window.removeEventListener("error",r)}var m=[];for(n in m.push(a+"="+c),s)O.call(s,n)&&m.push((l?g(n):n)+"="+(l?g(s[n]):s[n]));return i=(i+=(~i.indexOf("?")?"&":"?")+m.join("&")).replace("?&","?"),d.src=i,new Promise(function(n,o){u&&(t=setTimeout(function(){f(),o(new Error("Timeout"))},u)),r=function(e){var n=e.filename,r=e.error;n===i&&(f(),o(r))},window.addEventListener("error",r),d.onerror=function(){f(),o(new Error("Script error"))},window[c]=function(e){f(),n(e)},function(e){var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(e,n):document.head.appendChild(e)}(d)})}var r=n,o=n;return r.default=o,r});
